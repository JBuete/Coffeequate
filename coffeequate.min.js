/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,n){"function"==typeof define&&define.amd?define(n):(t.libGlobalName=n(),window.coffeequate=window.CQ=n())}(this,function(){var t,n,e;return function(r){function i(t,n){return v.call(t,n)}function o(t,n){var e,r,i,o,l,a,u,s,p,c,h=n&&n.split("/"),f=w.map,d=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=h.concat(t.split("/")),s=0;s<t.length;s+=1)if(c=t[s],"."===c)t.splice(s,1),s-=1;else if(".."===c){if(1===s&&(".."===t[2]||".."===t[0]))break;s>0&&(t.splice(s-1,2),s-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||d)&&f){for(e=t.split("/"),s=e.length;s>0;s-=1){if(r=e.slice(0,s).join("/"),h)for(p=h.length;p>0;p-=1)if(i=f[h.slice(0,p).join("/")],i&&(i=i[r])){o=i,l=s;break}if(o)break;!a&&d&&d[r]&&(a=d[r],u=s)}!o&&a&&(o=a,l=u),o&&(e.splice(0,l,o),t=e.join("/"))}return t}function l(t,n){return function(){return f.apply(r,x.call(arguments,0).concat([t,n]))}}function a(t){return function(n){return o(n,t)}}function u(t){return function(n){g[t]=n}}function s(t){if(i(m,t)){var n=m[t];delete m[t],b[t]=!0,h.apply(r,n)}if(!i(g,t)&&!i(b,t))throw new Error("No "+t);return g[t]}function p(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function c(t){return function(){return w&&w.config&&w.config[t]||{}}}var h,f,d,y,g={},m={},w={},b={},v=Object.prototype.hasOwnProperty,x=[].slice;d=function(t,n){var e,r=p(t),i=r[0];return t=r[1],i&&(i=o(i,n),e=s(i)),i?t=e&&e.normalize?e.normalize(t,a(n)):o(t,n):(t=o(t,n),r=p(t),i=r[0],t=r[1],i&&(e=s(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},y={require:function(t){return l(t)},exports:function(t){var n=g[t];return"undefined"!=typeof n?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},h=function(t,n,e,o){var a,p,c,h,f,w,v=[];if(o=o||t,"function"==typeof e){for(n=!n.length&&e.length?["require","exports","module"]:n,f=0;f<n.length;f+=1)if(h=d(n[f],o),p=h.f,"require"===p)v[f]=y.require(t);else if("exports"===p)v[f]=y.exports(t),w=!0;else if("module"===p)a=v[f]=y.module(t);else if(i(g,p)||i(m,p)||i(b,p))v[f]=s(p);else{if(!h.p)throw new Error(t+" missing "+p);h.p.load(h.n,l(o,!0),u(p),{}),v[f]=g[p]}c=e.apply(g[t],v),t&&(a&&a.exports!==r&&a.exports!==g[t]?g[t]=a.exports:c===r&&w||(g[t]=c))}else t&&(g[t]=e)},t=n=f=function(t,n,e,i,o){return"string"==typeof t?y[t]?y[t](n):s(d(t,n).f):(t.splice||(w=t,n.splice?(t=n,n=e,e=null):t=r),n=n||function(){},"function"==typeof e&&(e=i,i=o),i?h(r,t,n,e):setTimeout(function(){h(r,t,n,e)},4),f)},f.config=function(t){return w=t,w.deps&&f(w.deps,w.callback),f},t._defined=g,e=function(t,n,e){n.splice||(e=n,n=[]),i(g,t)||i(m,t)||(m[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("lib/almond",function(){}),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};e("nodes",[],function(){var t,e,r;return t=function(){function t(t){this.label=t}return t.prototype.getChildren=function(){return[]},t.prototype.getAllVariables=function(){return[]},t.prototype.toDrawingNode=function(){throw new Error("toDrawingNode not implemented for "+self.toString())},t.prototype.toLaTeX=function(){return this.toDrawingNode().renderLaTeX()},t.prototype.toString=function(){return this.toDrawingNode().renderString()},t.prototype.toMathML=function(){return this.toDrawingNode().renderMathML()},t.prototype.stringEqual=function(t){return t.toString()===this.toString()},t}(),r=function(t){function e(t,n){this.children=null!=n?n:null,null==this.children&&(this.children=[]),e.__super__.constructor.call(this,t)}return n(e,t),e.prototype.getChildren=function(){return this.children},e}(t),e=function(t){function e(t,n,e){this.label=t,this.children={left:n,right:e}}return n(e,t),e.prototype.getChildren=function(){return[this.children.left,this.children.right]},e}(t),{BasicNode:t,RoseNode:r,BinaryNode:e}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};e("parse",["require"],function(t){var e,r,i,o,l,a,u,s;return o=function(t){function e(t,n){this.input=t,this.type=n}return n(e,t),e.prototype.toString=function(){return"Could not parse '"+this.input+"' as "+this.type},e}(Error),a=/^@*[a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ][a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ_\-\d]*$/,r=/^-?\d+(e\d+)?$/,e=/^-?\d+(\.\d+)?(e-?\d+(\.\d+)?)?$/,l=/^\\@*[a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ][a-zA-Z\u0391-\u03A9\u03B1-\u03C9ϕϖϱϰϑϵ_\-\d]*$/,i=/^[^:]*::\{[^:+]*\}$/,s=function(n){var p,c,h;if(/\^/.test(n))throw new Error("Unexpected carat (^). Coffeequate uses ** for exponentiation.");if(i.test(n))return p=n.split("::"),c=s(p[0]),c.units=u.parse(p[1].slice(1,p[1].length-1)),c;if(n=n.trim(),h=t("terminals"),r.test(n))return new h.Constant(n,1,"rational");if(e.test(n))return new h.Constant(n,1,"float");if(a.test(n))return"σ"===n[0]?new h.Uncertainty(n.slice(1)):new h.Variable(n);if(l.test(n))return new h.SymbolicConstant(n.slice(1));throw new o(n,"terminal")},u=function(){function n(t,n){function e(){this.constructor=t}e.prototype=n.prototype,t.prototype=new e}function e(t,n,e,r,i,o){this.message=t,this.expected=n,this.found=e,this.offset=r,this.line=i,this.column=o,this.name="SyntaxError"}function r(n){function r(t){function e(t,e,r){var i,o;for(i=e;r>i;i++)o=n.charAt(i),"\n"===o?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return J!==t&&(J>t&&(J=0,Y={line:1,column:1,seenCR:!1}),e(Y,J,t),J=t),Y}function i(t){tn>K||(K>tn&&(tn=K,nn=[]),nn.push(t))}function o(t,i,o){function l(t){var n=1;for(t.sort(function(t,n){return t.description<n.description?-1:t.description>n.description?1:0});n<t.length;)t[n-1]===t[n]?t.splice(n,1):n++}function a(t,n){function e(t){function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+n(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+n(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+n(t)})}var r,i,o,l=new Array(t.length);for(o=0;o<t.length;o++)l[o]=t[o].description;return r=t.length>1?l.slice(0,-1).join(", ")+" or "+l[t.length-1]:l[0],i=n?'"'+e(n)+'"':"end of input","Expected "+r+" but "+i+" found."}var u=r(o),s=o<n.length?n.charAt(o):null;return null!==i&&l(i),new e(null!==t?t:a(i,s),i,s,o,u.line,u.column)}function l(){var t;return t=a()}function a(){var t,e,r,o;return t=K,e=u(),e!==d?(43===n.charCodeAt(K)?(r=w,K++):(r=d,0===en&&i(b)),r!==d?(o=a(),o!==d?(H=t,e=v(e,o),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,e=u(),e!==d?(45===n.charCodeAt(K)?(r=x,K++):(r=d,0===en&&i(A)),r!==d?(o=a(),o!==d?(H=t,e=S(e,o),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,e=u(),e!==d&&(H=t,e=V(e)),t=e)),t}function u(){var t,e,r,o;return t=K,e=p(),e!==d?(42===n.charCodeAt(K)?(r=M,K++):(r=d,0===en&&i(C)),r!==d?(o=u(),o!==d?(H=t,e=E(e,o),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,e=p(),e!==d?(47===n.charCodeAt(K)?(r=_,K++):(r=d,0===en&&i(T)),r!==d?(o=u(),o!==d?(H=t,e=q(e,o),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,e=p(),e!==d&&(H=t,e=N(e)),t=e)),t}function p(){var t,e,r,o;return t=K,e=c(),e!==d?(n.substr(K,2)===L?(r=L,K+=2):(r=d,0===en&&i(O)),r!==d?(o=c(),o!==d?(H=t,e=j(e,o),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,e=c(),e!==d&&(H=t,e=N(e)),t=e),t}function c(){var t,e,r,o,l;if(t=K,e=[],U.test(n.charAt(K))?(r=n.charAt(K),K++):(r=d,0===en&&i(P)),r!==d)for(;r!==d;)e.push(r),U.test(n.charAt(K))?(r=n.charAt(K),K++):(r=d,0===en&&i(P));else e=m;if(e!==d)if(n.substr(K,3)===k?(r=k,K+=3):(r=d,0===en&&i(D)),r!==d){if(o=[],X.test(n.charAt(K))?(l=n.charAt(K),K++):(l=d,0===en&&i(R)),l!==d)for(;l!==d;)o.push(l),X.test(n.charAt(K))?(l=n.charAt(K),K++):(l=d,0===en&&i(R));else o=m;o!==d?(125===n.charCodeAt(K)?(l=F,K++):(l=d,0===en&&i(I)),l!==d?(H=t,e=B(e,o),t=e):(K=t,t=m)):(K=t,t=m)}else K=t,t=m;else K=t,t=m;if(t===d){if(t=K,e=[],U.test(n.charAt(K))?(r=n.charAt(K),K++):(r=d,0===en&&i(P)),r!==d)for(;r!==d;)e.push(r),U.test(n.charAt(K))?(r=n.charAt(K),K++):(r=d,0===en&&i(P));else e=m;e!==d&&(H=t,e=z(e)),t=e,t===d&&(t=K,40===n.charCodeAt(K)?(e=Z,K++):(e=d,0===en&&i($)),e!==d?(r=a(),r!==d?(41===n.charCodeAt(K)?(o=W,K++):(o=d,0===en&&i(G)),o!==d?(H=t,e=V(r),t=e):(K=t,t=m)):(K=t,t=m)):(K=t,t=m),t===d&&(t=K,45===n.charCodeAt(K)?(e=x,K++):(e=d,0===en&&i(A)),e!==d?(r=c(),r!==d?(H=t,e=Q(r),t=e):(K=t,t=m)):(K=t,t=m)))}return t}var h,f=arguments.length>1?arguments[1]:{},d={},y={start:l},g=l,m=d,w="+",b={type:"literal",value:"+",description:'"+"'},v=function(t,n){return new operators.Add(t,n)},x="-",A={type:"literal",value:"-",description:'"-"'},S=function(t,n){return new operators.Add(t,new operators.Mul(n,"-1"))},V=function(t){return t},M="*",C={type:"literal",value:"*",description:'"*"'},E=function(t,n){return new operators.Mul(t,n)},_="/",T={type:"literal",value:"/",description:'"/"'},q=function(t,n){return new operators.Mul(t,new operators.Pow(n,"-1"))},N=function(t){return t},L="**",O={type:"literal",value:"**",description:'"**"'},j=function(t,n){return new operators.Pow(t,n)},U=/^[^()+\-*\/{}:]/,P={type:"class",value:"[^()+\\-*\\/{}:]",description:"[^()+\\-*\\/{}:]"},k="::{",D={type:"literal",value:"::{",description:'"::{"'},X=/^[^{}]/,R={type:"class",value:"[^{}]",description:"[^{}]"},F="}",I={type:"literal",value:"}",description:'"}"'},B=function(t,n){return s(t.join("")+"::{"+n.join("")+"}")},z=function(t){return s(t.join(""))},Z="(",$={type:"literal",value:"(",description:'"("'},W=")",G={type:"literal",value:")",description:'")"'},Q=function(t){return new operators.Mul(t,"-1")},K=0,H=0,J=0,Y={line:1,column:1,seenCR:!1},tn=0,nn=[],en=0;if("startRule"in f){if(!(f.startRule in y))throw new Error("Can't start parsing from rule \""+f.startRule+'".');g=y[f.startRule]}if(operators=t("operators"),h=g(),h!==d&&K===n.length)return h;throw h!==d&&K<n.length&&i({type:"end",description:"end of input"}),o(null,nn,tn)}return n(e,Error),{SyntaxError:e,parse:r}}(),{ParseError:o,SyntaxError:u.SyntaxError,stringToExpression:function(t,n){var e;return null==n&&(n=!0),e=u.parse(t),n?e.simplify():e},stringToTerminal:s}})}.call(this),function(){var t,n=[].slice,r={}.hasOwnProperty,i=function(t,n){function e(){this.constructor=t}for(var i in n)r.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};t={α:"\\alpha ",A:"A",β:"\\beta ",B:"B",χ:"\\chi ",Δ:"\\Delta ",δ:"\\delta ",ε:"\\varepsilon ",ϵ:"\\epsilon ",E:"E",Η:"\\Eta ",γ:"\\gamma ",Γ:"\\Gamma ",ι:"\\iota ",Ι:"I",κ:"\\kappa ",ϰ:"\\varkappa ",Κ:"K",λ:"\\lambda ",Λ:"\\Lambda ",μ:"\\mu ",Μ:"M",ν:"\\nu ",Ν:"N",ω:"\\omega ",Ω:"\\Omega ",ℴ:"o",O:"O",ϕ:"\\phi ",φ:"\\varphi ",Φ:"\\Phi ",π:"\\pi ",Π:"\\Pi ",ψ:"\\psi ",Ψ:"\\Psi ",ρ:"\\rho ",Ρ:"P",σ:"\\sigma ",ς:"\\varsigma ",Σ:"\\Sigma ",τ:"\\tau ",Τ:"T",θ:"\\theta ",Θ:"\\Theta ",υ:"\\upsilon ",ξ:"\\xi ",Ξ:"\\Xi ",ζ:"\\zeta ",Ζ:"Z",ϖ:"\\varpi ",ϱ:"\\varrho ",ϑ:"\\vartheta "},e("prettyRender",[],function(){var e,r,o,l,a,u,s,p,c,h;return o=function(){function t(){}return t.prototype.toString=function(){throw new Error("not implemented")},t.prototype.renderLaTeX=function(){throw new Error("not implemented")},t.prototype.bindingStrength=function(){return 8},t.prototype.bracketIfNeeded=function(t){return t.bindingStrength()<=this.bindingStrength()?new r(t):t},t}(),o.makeWithBrackets=function(){var t,e;return e=1<=arguments.length?n.call(arguments,0):[],t=new this,e=e.map(function(n){return n.bindingStrength()<=t.bindingStrength()?new r(n):n}),t.terms=e,t},e=function(t){function e(){var t;t=1<=arguments.length?n.call(arguments,0):[],this.terms=t}return i(e,t),e.prototype.bindingStrength=function(){return 4},e.prototype.renderLaTeX=function(){return this.terms.map(function(t){return t.renderLaTeX()}).join(" + ")},e.prototype.renderString=function(){return this.terms.map(function(t){return t.renderString()}).join(" + ")},e.prototype.renderMathML=function(){return this.terms.map(function(t){return t.renderMathML()}).join("<mo>+</mo>")},e}(o),a=function(t){function e(){var t;t=1<=arguments.length?n.call(arguments,0):[],this.terms=t}return i(e,t),e.prototype.bindingStrength=function(){return 6},e.prototype.renderLaTeX=function(){return this.terms.map(function(t){return t.renderLaTeX()}).join(" \\cdot ")},e.prototype.renderString=function(){return this.terms.map(function(t){return t.renderString()}).join("*")},e.prototype.renderMathML=function(){return this.terms.map(function(t){return t.renderMathML()}).join("<mo>&middot;</mo>")},e}(o),s=function(t){function n(t,n){this.left=t,this.right=n}return i(n,t),n.prototype.renderLaTeX=function(){return""+this.left.renderLaTeX()+"^{"+this.right.renderLaTeX()+"}"},n.prototype.renderString=function(){return""+this.left.renderString()+"**"+this.bracketIfNeeded(this.right).renderString()},n.prototype.renderMathML=function(){return"<msup>"+this.left.renderMathML()+this.right.renderMathML()+"</msup>"},n}(o),r=function(t){function n(t){this.contents=t}return i(n,t),n.prototype.bindingStrength=function(){return 9},n.prototype.renderLaTeX=function(){return"\\left("+this.contents.renderLaTeX()+"\\right)"},n.prototype.renderString=function(){return"("+this.contents.renderString()+")"},n.prototype.renderMathML=function(){return"<mfenced><mrow>"+this.contents.renderMathML()+"</mrow></mfenced>"},n}(o),u=function(t){function n(t,n){this.value=t,this.classname=null!=n?n:"constant"}return i(n,t),n.prototype.bindingStrength=function(){return 10},n.prototype.renderLaTeX=function(){return this.value+""},n.prototype.renderString=function(){return this.value+""},n.prototype.renderMathML=function(){return'<mn class="'+this.classname+'">'+this.value+"</mn>"},n}(o),h=function(n){function e(t,n){this.label=t,this.classname=null!=n?n:"variable"}return i(e,n),e.prototype.bindingStrength=function(){return 10},e.prototype.renderLaTeX=function(){var n,e,r,i,o;for(e="",o=this.label,r=0,i=o.length;i>r;r++)n=o[r],e+=n in t?t[n]:n;return e},e.prototype.renderString=function(){return this.label},e.prototype.renderMathML=function(){var t,n,e,r,i,o;for(o=this.label.split("-"),i=o[0],t=0;"@"===i[0];)t+=1,i=i.slice(1);return e='<mover accent="true">',n="<mrow><mo>"+function(){var n,e;for(e=[],r=n=0;t>=0?t>n:n>t;r=t>=0?++n:--n)e.push(".");return e}().join("")+"</mo></mrow></mover>",i.length>1?e+'<msub class="'+this.classname+'"><mi>'+i[0]+"</mi><mi>"+i.slice(1)+"</mi></msub>"+n:'<mi class="'+this.classname+'">'+i+"</mi>"},e}(o),l=function(t){function n(t,n){this.top=t,this.bottom=n}return i(n,t),n.prototype.bindingStrength=function(){return 8},n.prototype.renderLaTeX=function(){return"\\frac{"+this.top.renderLaTeX()+"}{"+this.bottom.renderLaTeX()+"}"},n.prototype.renderString=function(){return""+this.bracketIfNeeded(this.top).renderString()+"/"+this.bracketIfNeeded(this.bottom).renderString()},n.prototype.renderMathML=function(t,n){return"<mfrac>      <mrow>"+this.top.renderMathML(t,n)+"</mrow>      <mrow>"+this.bottom.renderMathML(t,n)+"</mrow>      </mfrac>"},n}(o),p=function(t){function e(t,n){this.contents=t,this.power=null!=n?n:null}return i(e,t),e.prototype.renderLaTeX=function(){return this.power&&2!==this.power?"\\sqrt["+this.power+"]{"+this.contents.renderLaTeX()+"}":"\\sqrt{"+this.contents.renderLaTeX()+"}"},e.prototype.renderString=function(){return this.power&&2!==this.power?""+this.bracketIfNeeded(this.contents).renderString()+" ** (1/"+this.power+")":"sqrt("+this.contents.renderString()+")"},e.prototype.renderMathML=function(){var t,e,r,i;return t=1<=arguments.length?n.call(arguments,0):[],this.power&&2!==this.power?"<mroot>                  <mrow>                    "+(e=this.power).renderMathML.apply(e,t)+"                  </mrow>                  <mrow>                    "+(r=this.contents).renderMathML.apply(r,t)+"                  </mrow>                </mroot>":"<msqrt>                  "+(i=this.contents).renderMathML.apply(i,t)+"                </msqrt>"},e}(o),c=function(t){function e(t,n){this.label=t,this["class"]=null!=n?n:"default"}return i(e,t),e.prototype.bindingStrength=function(){return 9},e.prototype.renderLaTeX=function(){return"\\sigma_{"+this.label+"}"},e.prototype.renderString=function(){return"σ("+this.label+")"},e.prototype.renderMathML=function(){var t,e;return e=1<=arguments.length?n.call(arguments,0):[],t=new h(this.label),"<msub><mo>&sigma;</mo>"+t.renderMathML.apply(t,e)+"</msub>"},e}(o),{DrawingNode:o,Add:e,Mul:a,Pow:s,Bracket:r,Number:u,Variable:h,Fraction:l,Surd:p,Uncertainty:c}})}.call(this),function(){var t;t={c:299792458,G:6.67384e-11,π:Math.PI,PI:Math.PI,E:Math.E,e:Math.E,ε0:8.85418782e-12,μ0:125663706e-14,k:1.3806488e-23,h:6.62606957e-34,hbar:1.05457173e-34,NA:6.02214129e23,mu:1.66053892e-27,a0:5.29e-11,ke:1/(8.85418782e-12*4*Math.PI),ec:1.60217657e-19,R:8.3144621},e("constants",[],function(){return t})}.call(this),function(){var t={}.hasOwnProperty,r=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n},i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("terminals",["parse","nodes","prettyRender","constants"],function(t,e,o,l){var a,u,s,p,c,h;return s=function(t){function n(){return h=n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.evaluate=function(){throw new Error("Not implemented.")},n.prototype.copy=function(){throw new Error("Not implemented.")},n}(e.BasicNode),a=function(t){function e(t,n,e){switch(this.numerator=t,this.denominator=null!=n?n:1,this.mode=null!=e?e:"rational",this.cmp=-6,this.mode){case"rational":this.numerator=parseInt(this.numerator),this.denominator=parseInt(this.denominator),this.simplifyInPlace();break;case"float":this.numerator=parseFloat(this.numerator),this.denominator=parseFloat(this.denominator),this.numerator/=this.denominator,this.denominator=1}}return r(e,t),e.prototype.evaluate=function(){return parseFloat(this.numerator/this.denominator)},e.prototype.copy=function(){return new e(this.numerator,this.denominator,this.mode)},e.prototype.compareSameType=function(t){return this.evaluate()<t.evaluate()?-1:this.evaluate()===t.evaluate()?0:1},e.prototype.mul=function(t){var n;return n=this.mode===t.mode?this.mode:"float",new e(this.numerator*t.numerator,this.denominator*t.denominator,n)},e.prototype.add=function(t){var n;return n=this.mode===t.mode?this.mode:"float",new e(t.denominator*this.numerator+this.denominator*t.numerator,this.denominator*t.denominator,n)},e.prototype.pow=function(t){var r,i,o,l,a;return"rational"===this.mode?"rational"===t.mode?(o=!1,t.numerator<0&&t.denominator<0?t=new e(-t.numerator,-t.denominator):t.numerator>0&&t.denominator<0?(o=!0,t=new e(t.numerator,-t.denominator)):t.numerator<0&&t.denominator>0&&(o=!0,t=new e(-t.numerator,t.denominator)),l=Math.pow(this.numerator,t.numerator),i=Math.pow(this.denominator,t.numerator),r=o?new e(i,l,"rational"):new e(l,i,"rational"),1===t.denominator?r:(a=n("operators"),new a.Pow(r,new e(1,t.denominator,"rational")))):new e(Math.pow(this.evaluate(),t.evaluate()),1,"float"):new e(Math.pow(this.evaluate(),t.evaluate()),1,"float")},e.prototype.equals=function(t){return t instanceof e?this.evaluate()===t.evaluate():!1},e.prototype.replaceVariables=function(){return this.copy()},e.prototype.getAllVariables=function(){return[]},e.prototype.sub=function(){return this.copy()},e.prototype.simplifyInPlace=function(){var t,n,e,r;for(t=this.numerator,n=this.denominator;0!==n;)r=[n,Math.round(10*(t%n))/10],t=r[0],n=r[1];return e=t,this.numerator/=e,this.numerator=Math.round(10*this.numerator)/10,this.denominator/=e,this.denominator=Math.round(10*this.denominator)/10},e.prototype.simplify=function(){var t;return t=this.copy(),t.simplifyInPlace(),t},e.prototype.expand=function(){return this.copy()},e.prototype.expandAndSimplify=function(){return this.simplify()},e.prototype.substituteExpression=function(){return[this.copy()]},e.prototype.getUncertainty=function(){return new e(0)},e.prototype.getVariableUnits=function(){return null},e.prototype.setVariableUnits=function(){},e.prototype.toDrawingNode=function(){var t,n;return n=o.Number,t=o.Fraction,1===this.denominator?new n(this.numerator):new t(new n(this.numerator),new n(this.denominator))},e.prototype.differentiate=function(){return new e(0)},e}(s),u=function(t){function n(t,n,e){this.label=t,this.value=null!=n?n:null,this.units=null!=e?e:null,this.cmp=-5}return r(n,t),n.prototype.copy=function(){return new n(this.label,this.value,this.units)},n.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},n.prototype.evaluate=function(){return null!=this.value?this.value:this.label in l?l[this.label]:null},n.prototype.equals=function(t){return t instanceof n?this.label===t.label&&this.value===t.value:!1},n.prototype.replaceVariables=function(){return this.copy()},n.prototype.getAllVariables=function(){return[]},n.prototype.sub=function(t,n,e,r,i){return null==e&&(e=null),null==r&&(r=!1),null==i&&(i=!1),i?null!=this.value?new a(this.value):this.label in l?new a(l[this.label]):this.copy():this.copy()},n.prototype.simplify=function(){return this.copy()},n.prototype.expand=function(){return this.copy()},n.prototype.expandAndSimplify=function(){return this.copy()},n.prototype.substituteExpression=function(){return[this.copy()]},n.prototype.getUncertainty=function(){return new a(0)},n.prototype.getVariableUnits=function(){return null},n.prototype.setVariableUnits=function(){return null},n.prototype.toDrawingNode=function(){var t;return t=o.Variable,new t(this.label,"constant symbolic-constant")},n.prototype.differentiate=function(){return new a(0)},n}(s),c=function(t){function n(t,n){this.label=t,this.units=null!=n?n:null,this.cmp=-4}return r(n,t),n.prototype.copy=function(){return new n(this.label,this.units)},n.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},n.prototype.equals=function(t,e){var r;return null==e&&(e=null),t instanceof n?null!=e?(r=this.label,i.call(e.get(t.label),r)>=0):t.label===this.label:!1},n.prototype.replaceVariables=function(t){var n;return n=this.copy(),this.label in t&&(n.label=t[this.label]),n},n.prototype.getAllVariables=function(){return[this.label]},n.prototype.sub=function(t){var n;return this.label in t?(n=t[this.label],null!=n.copy?n.copy():new a(n)):this.copy()},n.prototype.substituteExpression=function(t,n,e,r){var o,l,a,u;return null==e&&(e=null),null==r&&(r=!1),null==e&&(e={get:function(t){return[t]}}),a=e.get(n),l=r?t.solve(n):[t],this.label===n||(u=this.label,i.call(a,u)>=0)?function(){var t,n,e;for(e=[],t=0,n=l.length;n>t;t++)o=l[t],e.push(o.copy());return e}():[this.copy()]},n.prototype.getUncertainty=function(){return new p(this.label)},n.prototype.getVariableUnits=function(t,n){var e;if(null!=n){if(e=this.label,i.call(n.get(t),e)>=0)return this.units}else if(this.label===t)return this.units;return null},n.prototype.setVariableUnits=function(t,n,e){var r;if(null!=n){if(r=this.label,i.call(n.get(t),r)>=0)return this.units=e}else if(this.label===t)return this.units=e},n.prototype.simplify=function(){return this.copy()},n.prototype.expand=function(){return this.copy()},n.prototype.expandAndSimplify=function(){return this.copy()},n.prototype.toDrawingNode=function(){var t;return t=o.Variable,new t(this.label)},n.prototype.differentiate=function(t){return t===this.label?new a(1):new a(0)},n}(s),p=function(t){function n(t){this.label=t,this.cmp=-4.5}return r(n,t),n.prototype.copy=function(){return new n(this.label)},n.prototype.compareSameType=function(t){return this.label<t.label?-1:this.label===t.label?0:1},n.prototype.equals=function(t,e){var r;return null==e&&(e=null),t instanceof n?null!=e?(r=this.label,i.call(e.get(t.label),r)>=0):t.label===this.label:!1},n.prototype.replaceVariables=function(t){var n;return n=this.copy(),this.label in t&&(n.label=t[this.label]),n},n.prototype.getAllVariables=function(){return[this.label]},n.prototype.sub=function(t,n,e,r){var i;return null==e&&(e=null),null==r&&(r=!1),this.label in n&&null!=n[this.label]?(i=n[this.label],null!=i.copy?i.copy():new a(i)):r?new a("0"):this.copy()},n.prototype.substituteExpression=function(t,n,e,r){throw null==e&&(e=null),null==r&&(r=!1),new Error("Can't sub uncertainties")},n.prototype.getUncertainty=function(){throw new Error("Can't take uncertainty of an uncertainty")},n.prototype.getVariableUnits=function(){throw new Error("Can't do that with uncertainties")},n.prototype.setVariableUnits=function(){throw new Error("Can't do that with uncertainties")},n.prototype.simplify=function(){return this.copy()},n.prototype.expand=function(){return this.copy()},n.prototype.expandAndSimplify=function(){return this.copy()},n.prototype.toDrawingNode=function(){var t;return t=o.Uncertainty,new t(this.label)},n.prototype.differentiate=function(){throw new Error("Can't differentiate uncertainties!")},n}(s),{Terminal:s,Variable:c,Constant:a,SymbolicConstant:u,Uncertainty:p}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};e("AlgebraError",[],function(){var t;return t=function(t){function e(t,n,r){null==r&&(r=null),e.__super__.constructor.call(this,"Unsolvable: "+t+" for "+n+(r?"; "+r:""))}return n(e,t),e}(Error)})}.call(this),function(){var t=[].slice;e("parseArgs",["nodes","parse","terminals"],function(n,e,r){var i;return i=function(){var i,o,l,a,u;for(o=1<=arguments.length?t.call(arguments,0):[],l=[],a=0,u=o.length;u>a;a++)if(i=o[a],"string"==typeof i||i instanceof String)l.push(e.stringToTerminal(i));else if("number"==typeof i||i instanceof Number)l.push(new r.Constant(i));else{if(!(i instanceof r.Terminal||i instanceof n.BasicNode||null!=i.isTerminal))throw new Error("Invalid argument "+i+", ("+typeof i+"), ("+i.toString()+")");l.push(i)}return l}})}.call(this),function(){e("compare",[],function(){var t;return t=function(t,n){return null!=t.cmp&&null!=n.cmp?t.cmp===n.cmp?t.compareSameType(n):(t.cmp-n.cmp)/Math.abs(t.cmp-n.cmp):0}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n},r=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("operators/Add",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(t,e,o,l,a,u,s){var p,c;return c=function(t){var n,e,r,i,o,l,a,u,s;if(1===t.length)return function(){var e,r,i,o;for(i=t[0],o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n);return o}();for(r=[],u=t[0],i=0,l=u.length;l>i;i++)for(n=u[i],s=c(t.slice(1)),o=0,a=s.length;a>o;o++)e=s[o],r.push([n].concat(e));return r},p=function(t){function p(){var t;if(t=1<=arguments.length?r.call(arguments,0):[],t.length<1)throw new Error("Add nodes must have at least one child.");this.cmp=-1,t=l.apply(null,t),p.__super__.constructor.call(this,"+",t)}return n(p,t),p.prototype.copy=function(){var t,n;return t=function(){var t,e,r,i;for(r=this.children,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(null!=n.copy?n.copy():n);return i}.call(this),function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,t,function(){})},p.prototype.compareSameType=function(t){var n,e,r,i,o,l,a;for(i=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,a=this.children,r=o=0,l=a.length;l>o;r=++o){if(e=a[r],null==t.children[r])return 1;if(n=u(this.children[r],t.children[r]),0!==n)return n}return i},p.prototype.getVariableUnits=function(t,n){var r,o,l,a,u,s,p;for(l=null!=n?n.get(t):[t],s=this.children,a=0,u=s.length;u>a;a++){if(r=s[a],r instanceof e.Variable&&(p=r.label,i.call(l,p)>=0))return r.units;if(o=r.getVariableUnits(t,n),null!=o)return o}return null},p.prototype.setVariableUnits=function(t,n,e){var r,i,o,l,a,u;for(i=null!=n?n.get(t):{get:function(t){return[t]}},a=this.children,u=[],o=0,l=a.length;l>o;o++)r=a[o],u.push(r.setVariableUnits(t,n,e));return u},p.prototype.expand=function(){var t,n,e,r,i,o,l,a,u,s;for(r=[],u=this.children,i=0,l=u.length;l>i;i++)if(e=u[i],null!=e.expand?e=e.expand():null!=e.copy&&(e=e.copy()),e instanceof p)for(s=e.children,o=0,a=s.length;a>o;o++)n=s[o],r.push(n);else r.push(e);return t=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,r,function(){}),t.sort(),t},p.prototype.sort=function(){var t,n,e,r;for(r=this.children,n=0,e=r.length;e>n;n++)t=r[n],"function"==typeof t.sort&&t.sort();return this.children.sort(u)},p.prototype.equals=function(t,n){var e,r,i,o,l;if(!(t instanceof p))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,r=i=0,o=l.length;o>i;r=++i)if(e=l[r],null!=e.equals){if(!e.equals(t.children[r],n))return!1}else if(e!==t.children[r])return!1;return!0},p.prototype.simplify=function(t){var n,r,i,o,l,u,s,c,h,f,d,y,g,m,w,b,v,x,A,S,V,M,C,E,_,T,q,N,L,O,j;for(n=a("operators/Mul"),null==t&&(t={get:function(t){return[t]}}),m=[],L=this.children,v=0,V=L.length;V>v;v++)i=L[v],null!=i.simplify?i=i.simplify(t):null!=i.copy&&(i=i.copy()),m.push(i);for(f=[],o=null,s=0;s<m.length;){if(g=m[s],g instanceof p){for(m.splice(s,1)[0],O=g.children,x=0,M=O.length;M>x;x++)r=O[x],m.push(r);s-=1}else if(g instanceof e.Constant)o=null!=o?o.add(g):g.copy();else if(g instanceof n){for(l=null,w=null,j=g.children,A=0,C=j.length;C>A;A++)i=j[A],i instanceof e.Constant?l=null!=l?l.multiply(i):i.copy():null!=w?w.children.push(i):w=new n(i);if(1===w.children.length&&(w=w.children[0]),null!=l&&null==w)o=null!=o?o.add(l):l.copy();else{for(null==l&&(l=new e.Constant("1")),u=!1,c=S=0,E=f.length;E>S;c=++S)h=f[c],null!=h[0].equals?h[0].equals(w,t)&&(f[c][1]=new p(h[1],l),f[c][1]=f[c][1].simplify(t),u=!0):h[0]===w&&(f[c][1]=new p(h[1],l),f[c][1]=f[c][1].simplify(t),u=!0);u||f.push([w,l])}}else{for(u=!1,c=q=0,_=f.length;_>q;c=++q)h=f[c],null!=h[0].equals?h[0].equals(g,t)&&(f[c][1]=new p(h[1],new e.Constant("1")),f[c][1]=f[c][1].simplify(t),u=!0):h[0]===g&&(f[c][1]=new p(h[1],new e.Constant("1")),f[c][1]=f[c][1].simplify(t),u=!0);u||f.push([g,new e.Constant("1")])}s+=1}for(d=null,N=0,T=f.length;T>N;N++)h=f[N],null!=h[0].children&&1===h[0].children.length&&(h[0]=h[0].children[0]),1!==("function"==typeof(b=h[1]).evaluate?b.evaluate():void 0)?(y=new n(h[0],h[1]),y=y.simplify(t)):y=h[0],null!=d?d.children.push(y):d=new p(y);return null==d?o:(null!=o&&0!==o.evaluate()&&d.children.push(o),d.sort(),1!==d.children.length?d:d.children[0])},p.prototype.expandAndSimplify=function(t){var n;return n=this.expand(),null!=n.simplify?n.simplify(t):n},p.prototype.solve=function(t,n){var r,l,u,s,c,h,f,d,y,g,m,w,b,v,x,A,S,V,M,C,E,_,T,q,N,L,O,j,U,P,k,D,X,R,F,I,B,z,Z,$,W,G,Q,K,H,J,Y,tn,nn,en,rn,on,ln,an,un,sn,pn,cn,hn,fn,dn,yn,gn,mn;for(null==n&&(n=null),r=a("operators/Mul"),l=a("operators/Pow"),w=this.expandAndSimplify(n),null==n&&(n={get:function(t){return[t]}}),I=[],B=[],W=null,G=0,J=n.length;J>G;G++)if(m=n[G],z=this.getVariableUnits(m),null!=z){W=z;break}if(w instanceof e.Terminal){if(w instanceof e.Variable&&(w.label===t||(an=w.label,i.call(n.get(t),an)>=0)))return[new e.Constant("0")];throw new o(w.toString(),t)}if(!(w instanceof p))return w.solve(t,n);for(un=w.children,Q=0,Y=un.length;Y>Q;Q++)if(F=un[Q],null!=F.copy&&(F=F.copy()),F instanceof l)F.children.left instanceof e.Variable&&(F.children.left.label===t||(pn=F.children.left.label,i.call(n.get(t),pn)>=0))?I.push(F):B.push(F);
else if(F instanceof r){for(h=!1,cn=F.children,K=0,tn=cn.length;tn>K;K++){if(X=cn[K],X instanceof e.Variable&&(X.label===t||(hn=X.label,i.call(n.get(t),hn)>=0))){I.push(F),h=!0;break}if(X instanceof l&&X.children.left instanceof e.Variable&&(X.children.left.label===t||(fn=X.children.left.label,i.call(n.get(t),fn)>=0))){I.push(F),h=!0;break}}h||B.push(F)}else F instanceof e.Variable&&(F.label===t||(dn=F.label,i.call(n.get(t),dn)>=0))?I.push(F):B.push(F);if(0===I.length)throw new o(w.toString(),t);for(b=[],x=[],C=[],_=[],H=0,nn=I.length;nn>H;H++)if(F=I[H],F instanceof e.Variable)b.push(new e.Constant("1"));else if(F instanceof l){if(!(F.children.right instanceof e.Constant))throw new o(w.toString(),t);if(P=F.children.right.evaluate(),!(F.children.left instanceof e.Variable&&(F.children.left.label===t||(yn=F.children.left.label,i.call(n.get(t),yn)>=0))))throw new o(w.toString(),t," (this shouldn't happen)");if(1===P)b.push(new e.Constant("1"));else if(2===P)x.push(new e.Constant("1"));else if(-1===P)C.push(new e.Constant("1"));else{if(-2!==P)throw new o(w.toString(),t," (not supported)");_.push(new e.Constant("1"))}}else if(F instanceof r){for(R=[],k=!1,V=!1,M=!1,gn=F.children,on=0,en=gn.length;en>on;on++)if(X=gn[on],X instanceof e.Variable&&(X.label===t||(mn=X.label,i.call(n.get(t),mn)>=0)));else if(X instanceof l){if(!(X.children.right instanceof e.Constant))throw new o(w.toString(),t);if(P=X.children.right.evaluate(),X.children.left instanceof e.Variable&&(X.children.left.label===t||(sn=X.children.left.label,i.call(n.get(t),sn)>=0)))if(1===P);else if(2===P)k=!0;else if(-1===P)V=!0;else{if(-2!==P)throw new o(w.toString(),t," (not supported)");M=!0}else R.push(X)}else R.push(X);S=R.length>0?function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(r,R,function(){}):new e.Constant("1"),k?x.push(S):V?C.push(S):M?_.push(S):b.push(S)}for(q=[],ln=0,rn=B.length;rn>ln;ln++)F=B[ln],O=new r("-1",null!=F.copy?F.copy():F),O=O.simplify(n),q.push(O);if(0!==q.length&&(N=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,q,function(){})),0!==B.length&&(U=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,B,function(){})),0!==b.length&&(v=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,b,function(){})),0!==x.length&&(A=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,x,function(){})),0!==C.length&&(E=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,C,function(){})),0!==_.length&&(T=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,_,function(){})),0===q.length&&(N=new e.Constant("0")),0===x.length){if(0===b.length){if(0===C.length){if(0===_.length)throw new o(w.toString(),t);return f=new r(new l(T,"1/2"),new l(N,"-1/2")),s=new r(-1,f.copy()),s=s.expandAndSimplify(n),c=f.expandAndSimplify(n),("function"==typeof s.equals?s.equals(c):void 0)?[s]:[s,c]}return 0===_.length?(f=new r(E,new l(N,"-1")),[f.expandAndSimplify(n)]):(L=new p(new r(U,new l(new e.Variable(t,W),2)),new r(E,new e.Variable(t,W)),T),L.solve(t,n))}if(0===C.length){if(0===_.length)return f=new r(N,new l(v,"-1")),[f.expandAndSimplify(n)];throw new o(w.toString(),t," (not supported)")}throw new o(w.toString(),t," (not supported)")}if(0===b.length){if(0===C.length){if(0===_.length)return f=new l(new r(N,new l(A,"-1")),"1/2"),s=new r("-1",f.copy()),s=s.expandAndSimplify(n),c=f.expandAndSimplify(n),("function"==typeof s.equals?s.equals(c):void 0)?[s]:[s,c];throw new o(w.toString(),t," (not supported)")}throw new o(w.toString(),t," (not supported)")}if(C.length>0||_.length>0)throw new o(w.toString(),t," (not supported)");return null!=U?(u=A,d=v,y=U,g=new p(new l(d,"2"),new r("-4",u,y)),D=new l(g,"1/2"),Z=new r(new p(new r("-1",d),D),new l(new r("2",u),"-1")),$=new r("-1",new p(d,D),new l(new r("2",u),"-1")),Z=Z.expandAndSimplify(n),$=$.expandAndSimplify(n),null!=Z.equals&&Z.equals($)?[Z]:[Z,$]):(j=new l(A,"-1"),O=new r("-1",v,j),O=O.simplify(n),[0,O])},p.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,u,s,p;for(o={},p=this.children,l=0,u=p.length;u>l;l++)if(t=p[l],t instanceof e.Variable)o[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),a=0,s=n.length;s>a;a++)i=n[a],o[i]=!0;r=[];for(i in o)r.push(i);return r},p.prototype.replaceVariables=function(t){var n,r,i,o,l,a;for(r=[],a=this.children,i=o=0,l=a.length;l>o;i=++o)n=a[i],n instanceof e.Variable&&n.label in t?(r.push(n.copy()),r[i].label=t[n.label]):null!=n.replaceVariables?r.push(n.replaceVariables(t)):r.push(n.copy());return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,r,function(){})},p.prototype.sub=function(t,n,r,i,o){var l,a,u,s,c,h,f,d,y,g,m,w;null==r&&(r=null),null==i&&(i=!1),null==o&&(o=!1);for(h in t)null==t[h].copy&&(t[h]=new e.Constant(t[h]));for(null==r&&(r={get:function(t){return[t]}}),a=[],w=this.children,d=0,g=w.length;g>d;d++)if(l=w[d],l instanceof e.Variable){for(f=r.get(l.label),c=!1,y=0,m=f.length;m>y;y++)if(u=f[y],u in t){a.push(t[u].copy()),c=!0;break}c||a.push(l.copy())}else null!=l.sub?a.push(l.sub(t,n,r,i,o)):a.push(l.copy());return s=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,a,function(){}),s=s.expandAndSimplify(r)},p.prototype.substituteExpression=function(t,n,r,o){var l,a,u,s,h,f,d,y,g,m,w,b,v,x,A,S,V;for(null==r&&(r=null),null==o&&(o=!1),y=o?t.solve(n,r):[t],null==r&&(r={get:function(t){return[t]}}),g=r.get(n),d=[],m=0,v=y.length;v>m;m++){for(h=y[m],s=[],S=this.children,w=0,x=S.length;x>w;w++)l=S[w],l instanceof e.Variable&&(l.label===n||(V=l.label,i.call(g,V)>=0))?s.push([h.copy()]):null!=l.substituteExpression?s.push(l.substituteExpression(h,n,r)):s.push([l.copy()]);u=c(s)}for(b=0,A=u.length;A>b;b++)a=u[b],f=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,a,function(){}),d.push(f.expandAndSimplify(r));return d},p.prototype.toDrawingNode=function(){var t;return t=s.Add,t.makeWithBrackets.apply(t,this.children.map(function(t){return t.toDrawingNode()}))},p.prototype.differentiate=function(t){var n,e;return e=this.children.map(function(n){return n.differentiate(t)}),n=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,e,function(){}),n.expandAndSimplify()},p}(t.RoseNode)})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n},r=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("operators/Mul",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(t,e,o,l,a,u,s){var p,c;return c=function(t){var n,e,r,i,o,l,a,u,s;if(1===t.length)return function(){var e,r,i,o;for(i=t[0],o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n);return o}();for(r=[],u=t[0],i=0,l=u.length;l>i;i++)for(n=u[i],s=c(t.slice(1)),o=0,a=s.length;a>o;o++)e=s[o],r.push([n].concat(e));return r},p=function(t){function p(){var t;if(t=1<=arguments.length?r.call(arguments,0):[],t.length<1)throw new Error("Mul nodes must have at least one child.");this.cmp=-2,t=l.apply(null,t),p.__super__.constructor.call(this,"*",t)}return n(p,t),p.prototype.copy=function(){var t,n;return t=function(){var t,e,r,i;for(r=this.children,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(null!=n.copy?n.copy():n);return i}.call(this),function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,t,function(){})},p.prototype.simplifyConstants=function(){var t,n,r,i,o,l;for(n=new e.Constant("1"),r=null,l=this.children,i=0,o=l.length;o>i;i++)t=l[i],t instanceof e.Constant?n=n.mul(t):null!=r?r.children.push(t):r=new p(t);return null==r?n:1===n.evaluate()?r:new p(n,r)},p.prototype.compareSameType=function(t){var n,e,r,i,o,l,a;for(i=this.children.length===t.children.length?0:this.children.length<t.children.length?-1:1,a=this.children,r=o=0,l=a.length;l>o;r=++o){if(e=a[r],null==t.children[r])return 1;if(n=u(this.children[r],t.children[r]),0!==n)return n}return i},p.prototype.getVariableUnits=function(t,n){var r,o,l,a,u,s,p;for(l=null!=n?n.get(t):[t],s=this.children,a=0,u=s.length;u>a;a++){if(r=s[a],r instanceof e.Variable&&(p=r.label,i.call(l,p)>=0))return r.units;if(o=r.getVariableUnits(t,n),null!=o)return o}return null},p.prototype.setVariableUnits=function(t,n,e){var r,i,o,l,a,u;for(i=null!=n?n.get(t):{get:function(t){return[t]}},a=this.children,u=[],o=0,l=a.length;l>o;o++)r=a[o],u.push(r.setVariableUnits(t,n,e));return u},p.expandMulAdd=function(t,n){var e,r,i,o,l,u,s,c,h,f,d,y;for(e=a("operators/Add"),u=[],d=n.children,s=0,h=d.length;h>s;s++){if(i=d[s],null!=i.copy&&(i=i.copy()),i instanceof p)for(l=t.copy(),y=i.children,c=0,f=y.length;f>c;c++)r=y[c],l.children.push(r);else i instanceof e?l=p.expandMulAdd(t,i):1===t.children.length?(l=t.copy(),l.children.push(i.copy())):l=new p(t.copy(),i.copy());u.push(l)}return o=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(e,u,function(){}),o=o.expand()},p.prototype.equals=function(t,n){var e,r,i,o,l;if(!(t instanceof p))return!1;if(t.children.length!==this.children.length)return!1;for(l=this.children,r=i=0,o=l.length;o>i;r=++i)if(e=l[r],null!=e.equals){if(!e.equals(t.children[r],n))return!1}else if(e!==t.children[r])return!1;return!0},p.prototype.expand=function(){var t,n,e,r,i,o,l,u,s,c,h,f,d,y,g;for(t=a("operators/Add"),i=[],d=this.children,l=0,c=d.length;c>l;l++)n=d[l],null!=n.expand?n=n.expand():null!=n.copy&&(n=n.copy()),i.push(n);for(;i.length>1;)if(i[0]instanceof p)if(i[1]instanceof t)i[0]=p.expandMulAdd(i[0],i.splice(1,1)[0]);else if(i[1]instanceof p)for(y=i.splice(1,1)[0].children,u=0,h=y.length;h>u;u++)n=y[u],i[0].children.push(n);else i[0].children.push(i.splice(1,1)[0]);else if(i[0]instanceof t)if(i[1]instanceof t){for(r=[],g=i[0].children,s=0,f=g.length;f>s;s++)n=g[s],e=new p(n,i[1]),e=e.expand(),r.push(e);i.splice(1,1),i[0]=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(t,r,function(){}),i[0]=i[0].expand()}else i[0]=i[1]instanceof p?p.expandMulAdd(i.splice(1,1)[0],i[0]):new p(i[0],i.splice(1,1)[0]);else i[0]=new p(i[0]);return"function"==typeof(o=i[0]).sort&&o.sort(),i[0]},p.prototype.simplify=function(t){var n,r,i,o,l,u,s,c,h,f,d,y,g,m,w,b,v,x,A,S,V,M,C,E,_,T,q,N,L,O,j,U,P,k,D,X,R;for(n=a("operators/Add"),r=a("operators/Pow"),null==t&&(t={get:function(t){return[t]}}),v=[],j=this.children,A=0,C=j.length;C>A;A++)l=j[A],null!=l.simplify?l=l.simplify(t):null!=l.copy&&(l=l.copy()),v.push(l);for(d=[],u=null,c=0;c<v.length;){if(b=v[c],b instanceof p){for(l=v.splice(c,1)[0],U=l.children,S=0,E=U.length;E>S;S++)o=U[S],v.push(o);c-=1}else if(b instanceof e.Constant)u=null!=u?u.mul(b):b.copy();else if(b instanceof r){for(i=b.children.left,w=b.children.right,s=!1,h=V=0,_=d.length;_>V;h=++V)f=d[h],null!=f[0].equals?f[0].equals(i,t)&&(d[h][1]=new n(f[1],w),d[h][1]=d[h][1].simplify(t),1===(null!=(P=d[h][1].children)?P.length:void 0)&&(d[h][1]=d[h][1].children[0]),s=!0):f[0]===i&&(d[h][1]=new n(f[1],w),d[h][1]=d[h][1].simplify(t),1===(null!=(k=d[h][1].children)?k.length:void 0)&&(d[h][1]=d[h][1].children[0]),s=!0);s||d.push([i,w])}else{for(s=!1,h=M=0,T=d.length;T>M;h=++M)f=d[h],null!=f[0].equals?f[0].equals(b,t)&&(d[h][1]=new n(f[1],new e.Constant("1")),d[h][1]=d[h][1].simplify(t),1===(null!=(D=d[h][1].children)?D.length:void 0)&&(d[h][1]=d[h][1].children[0]),s=!0):f[0]===b&&(d[h][1]=new n(f[1],new e.Constant("1")),d[h][1]=d[h][1].simplify(t),1===(null!=(X=d[h][1].children)?X.length:void 0)&&(d[h][1]=d[h][1].children[0]),s=!0);s||d.push([b,new e.Constant("1")])}c+=1}if(0===(null!=u?"function"==typeof u.evaluate?u.evaluate():void 0:void 0))return new e.Constant("0");for(y=null,L=0,q=d.length;q>L;L++)f=d[L],1!==("function"==typeof(x=f[1]).evaluate?x.evaluate():void 0)?(g=new r(f[0],f[1]),g=g.simplify(t)):g=f[0],null!=y?y.children.push(g):y=new p(g);if(null==y)return u;for(null!=u&&1!==u.evaluate()&&y.children.push(u),y.sort(),m=!0,R=y.children,O=0,N=R.length;N>O;O++)if(l=R[O],!(l instanceof e.Constant)){m=!1;break}return m?y.simplifyConstants():1!==y.children.length?y:y.children[0]},p.prototype.sort=function(){var t,n,e,r;for(r=this.children,n=0,e=r.length;e>n;n++)t=r[n],"function"==typeof t.sort&&t.sort();return this.children.sort(u)},p.prototype.expandAndSimplify=function(t){var n;return n=this.expand(),null!=n.simplify?n.simplify(t):n},p.prototype.solve=function(t,n){var r,l,u,s,c,h,f,d,y;if(null==n&&(n=null),r=a("operators/Pow"),s=this.expandAndSimplify(n),null==n&&(n={get:function(t){return[t]}}),s instanceof e.Terminal){if(s instanceof e.Variable&&(s.label===t||(f=s.label,i.call(n.get(t),f)>=0)))return[new e.Constant("0")];throw new o(s.toString(),t)}if(!(s instanceof p))return s.solve(t,n);for(d=s.children,c=0,h=d.length;h>c;c++){if(l=d[c],l instanceof e.Variable&&(l.label===t||(y=l.label,i.call(n.get(t),y)>=0)))return[new e.Constant("0")];if(l instanceof r)try{return l.solve(t,n)}catch(g){if(u=g,u instanceof o)continue;throw u}}throw new o(s.toString(),t)},p.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,u,s,p;for(o={},p=this.children,l=0,u=p.length;u>l;l++)if(t=p[l],t instanceof e.Variable)o[t.label]=!0;else if(null!=t.getAllVariables)for(n=t.getAllVariables(),a=0,s=n.length;s>a;a++)i=n[a],o[i]=!0;r=[];for(i in o)r.push(i);return r},p.prototype.replaceVariables=function(t){var n,r,i,o,l,a;for(r=[],a=this.children,i=o=0,l=a.length;l>o;i=++o)n=a[i],n instanceof e.Variable&&n.label in t?(r.push(n.copy()),r[i].label=t[n.label]):null!=n.replaceVariables?r.push(n.replaceVariables(t)):r.push(n.copy());return function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,r,function(){})},p.prototype.sub=function(t,n,r,i,o){var l,a,u,s,c,h,f,d,y,g,m,w;null==r&&(r=null),null==i&&(i=!1),null==o&&(o=!1);for(h in t)null==t[h].copy&&(t[h]=new e.Constant(t[h]));for(null==r&&(r={get:function(t){return[t]}}),a=[],w=this.children,d=0,g=w.length;g>d;d++)if(l=w[d],l instanceof e.Variable){for(f=r.get(l.label),c=!1,y=0,m=f.length;m>y;y++)if(u=f[y],u in t){a.push(t[u].copy()),c=!0;break}c||a.push(l.copy())}else null!=l.sub?a.push(l.sub(t,n,r,i,o)):a.push(l.copy());return s=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,a,function(){}),s=s.expandAndSimplify(r)},p.prototype.substituteExpression=function(t,n,r,o){var l,a,u,s,h,f,d,y,g,m,w,b,v,x,A,S,V;for(null==r&&(r=null),null==o&&(o=!1),y=o?t.solve(n,r):[t],null==r&&(r={get:function(t){return[t]}}),g=r.get(n),d=[],m=0,v=y.length;v>m;m++){for(h=y[m],s=[],S=this.children,w=0,x=S.length;x>w;w++)l=S[w],l instanceof e.Variable&&(l.label===n||(V=l.label,i.call(g,V)>=0))?s.push([h.copy()]):null!=l.substituteExpression?s.push(l.substituteExpression(h,n,r)):s.push([l.copy()]);for(console.log("childrenExpressions",s),u=c(s),console.log("childrenArray",u),b=0,A=u.length;A>b;b++)a=u[b],f=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,a,function(){}),d.push(f.expandAndSimplify(r))}return console.log(d),d},p.prototype.toDrawingNode=function(){var t,n,r,i,o,l,u,p,c,h,f;for(t=a("operators/Pow"),e=a("terminals"),l=[],n=[],c=this.children,u=0,p=c.length;p>u;u++)r=c[u],r instanceof t?(o=r.children.right,o instanceof e.Constant?(o.denominator<0&&(o.denominator*=-1,o.numerator*=-1),o.numerator<0?n.push(new t(r.children.left,new e.Constant(o.numerator,-o.denominator)).toDrawingNode()):l.push(r.toDrawingNode())):l.push(r.toDrawingNode())):r instanceof e.Constant?(1!==r.numerator&&l.unshift(new s.Number(r.numerator)),1!==r.denominator&&n.unshift(new s.Number(r.denominator))):l.push(r.toDrawingNode());return 1===n.length?i=n[0]:n.length>1&&(i=(h=s.Mul).makeWithBrackets.apply(h,n)),1===l.length?l=l[0]:l.length>1&&(l=(f=s.Mul).makeWithBrackets.apply(f,l)),0===n.length?l:0===l.length?new s.Fraction(new s.Number(1),i):new s.Fraction(l,i)},p.prototype.differentiate=function(t){var n,e,r;if(n=a("operators/Add"),0===this.children.length)throw new Error("I'm pretty sure you need children in your Mul node");return 1===this.children.length?this.children[0].differentiate(t).expandAndSimplify():(e=this.children[0],r=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(p,this.children.slice(1),function(){}),new n(new p(e,r.differentiate(t)),new p(r,e.differentiate(t))).expandAndSimplify())},p}(t.RoseNode)})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n},r=[].slice,i=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};e("operators/Pow",["nodes","terminals","AlgebraError","parseArgs","require","compare","prettyRender"],function(t,e,o,l,a,u,s){var p;return p=function(t){function p(){var t,n,e,i;if(n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],null==n||null==e)throw new Error("Pow nodes must have two children.");if(t.length>0)throw new Error("Pow nodes must have two children.");this.cmp=-3,i=l(n,e),n=i[0],e=i[1],p.__super__.constructor.call(this,"**",n,e)}return n(p,t),p.prototype.copy=function(){return new p(null!=this.children.left.copy?this.children.left.copy():this.children.left,null!=this.children.right.copy?this.children.right.copy():this.children.right)},p.prototype.sort=function(){var t,n;return"function"==typeof(t=this.children.left).sort&&t.sort(),"function"==typeof(n=this.children.right).sort?n.sort():void 0},p.prototype.equals=function(t,n){if(!(t instanceof p))return!1;if(null!=this.children.left.equals){if(!this.children.left.equals(t.children.left,n))return!1}else if(this.children.left!==t.children.left)return!1;if(null!=this.children.right.equals){if(!this.children.right.equals(t.children.right,n))return!1}else if(this.children.right!==t.children.right)return!1;return!0},p.prototype.compareSameType=function(t){var n;return n=u(this.children.left,t.children.left),0!==n?n:u(this.children.right,t.children.right)},p.prototype.getVariableUnits=function(t,n){var r,o,l,a,u;return l=null!=n?n.get(t):{get:function(t){return[t]}},this.children.left instanceof e.Variable&&(a=this.children.left.label,i.call(l,a)>=0)?this.children.left.units:(r=this.children.left.getVariableUnits(t,n),null!=r?r:this.children.right instanceof e.Variable&&(u=this.children.right.label,i.call(l,u)>=0)?this.children.right.units:(o=this.children.right.getVariableUnits(t,n),null!=o?o:null))},p.prototype.setVariableUnits=function(t,n,e){var r;return r=null!=n?n.get(t):{get:function(t){return[t]}},this.children.left.setVariableUnits(t,n,e),this.children.right.setVariableUnits(t,n,e)},p.prototype.expand=function(){var t,n,r,i,o,l,u,s,c,h,f,d,y,g,m;if(n=a("operators/Mul"),t=a("operators/Add"),u=null!=this.children.left.expand?this.children.left.expand():null!=this.children.left.copy?this.children.left.copy():this.children.left,h=null!=this.children.right.expand?this.children.right.expand():null!=this.children.right.copy?this.children.right.copy():this.children.right,null!=u.children){if(u instanceof p)u.children.right=new n(u.children.right,h),u.expand();else if(u instanceof n)for(g=u.children,l=f=0,y=g.length;y>f;l=++f)r=g[l],c=new p(r,h),c=c.expand(),u.children[l]=c;else if(u instanceof t)if(h instanceof e.Constant&&0===h.evaluate()%1&&h.evaluate()>0){for(i=[],o=d=1,m=h.evaluate();m>=1?m>=d:d>=m;o=m>=1?++d:--d)i.push(u);s=function(t,n,e){e.prototype=t.prototype;var r=new e,i=t.apply(r,n);return Object(i)===i?i:r}(n,i,function(){}),s=s.expand(),u=s}else u=new p(u,h);return u}return new p(u,h)},p.prototype.simplify=function(t){var n,r,i,o,l;return n=a("operators/Mul"),null==t&&(t={get:function(t){return[t]}}),r=null!=this.children.left.simplify?this.children.left.simplify(t):null!=this.children.left.copy?this.children.left.copy():this.children.left,l=null!=this.children.right.simplify?this.children.right.simplify(t):null!=this.children.right.copy?this.children.right.copy():this.children.right,1===("function"==typeof l.evaluate?l.evaluate():void 0)?r:1===("function"==typeof r.evaluate?r.evaluate():void 0)?r:0===("function"==typeof l.evaluate?l.evaluate():void 0)?new e.Constant("1"):l instanceof e.Constant&&r instanceof e.Constant?r.pow(l):r instanceof p?(o=new n(r.children.right,l),i=new p(r.children.left,o),i=i.simplify(t)):new p(r,l)},p.prototype.expandAndSimplify=function(t){var n;return n=this.expand(),null!=n.simplify?n.simplify(t):n},p.prototype.solve=function(t,n){var r,l,u,s,c,h,f,d,y,g,m;if(r=a("operators/Mul"),null==n&&(n={get:function(t){return[t]}}),u=this.expandAndSimplify(n),u instanceof e.Terminal){if(u instanceof e.Variable&&(u.label===t||(g=u.label,i.call(n.get(t),g)>=0)))return[new e.Constant("0")];throw new o(u.toString(),t)}if(u instanceof p){if(u.children.left instanceof e.Variable){if(u.children.left.label===t||(m=u.children.left.label,i.call(n.get(t),m)>=0))return[new e.Constant("0")];throw new o(u.toString(),t)}if(u.children.left instanceof e.Terminal)throw new o(u.toString(),t);try{f=u.children.left.solve(t,n)}catch(w){throw l=w}if(null!=u.children.right.evaluate&&0===u.children.right.evaluate()%2){for(c=[],d=0,y=f.length;y>d;d++)h=f[d],s=new r(-1,h).simplify(n),null!=s.equals?(s.equals(h)||c.push(s),c.push(h)):(s!==h&&c.push(s),c.push(h));return c}return f}return u.solve(t,n)},p.prototype.sub=function(t,n,r,i,o){var l,a,u,s,c,h,f,d,y,g,m;null==r&&(r=null),null==i&&(i=!1),null==o&&(o=!1);for(h in t)null==t[h].copy&&(t[h]=new e.Constant(t[h]));if(null==r&&(r={get:function(t){return[t]}}),a=null,s=null,this.children.left instanceof e.Variable){for(f=r.get(this.children.left.label),c=!1,d=0,g=f.length;g>d;d++)if(l=f[d],l in t){a=t[l].copy(),c=!0;break}c||(a=this.children.left.copy())}else a=null!=this.children.left.sub?this.children.left.sub(t,n,r,i,o):this.children.left.copy();if(this.children.right instanceof e.Variable){for(f=r.get(this.children.right.label),c=!1,y=0,m=f.length;m>y;y++)if(l=f[y],l in t){s=t[l].copy(),c=!0;break}c||(s=this.children.right.copy())}else s=null!=this.children.right.sub?this.children.right.sub(t,n,r,i,o):this.children.right.copy();return u=new p(a,s),u=u.expandAndSimplify(r)},p.prototype.getAllVariables=function(){var t,n,r,i,o,l,a,u,s;if(o={},this.children.left instanceof e.Variable)o[this.children.left.label]=!0;else if(null!=this.children.left.getAllVariables)for(t=this.children.left.getAllVariables(),l=0,u=t.length;u>l;l++)i=t[l],o[i]=!0;if(this.children.right instanceof e.Variable)o[this.children.right.label]=!0;else if(null!=this.children.right.getAllVariables)for(r=this.children.right.getAllVariables(),a=0,s=r.length;s>a;a++)i=r[a],o[i]=!0;n=[];for(i in o)n.push(i);return n},p.prototype.replaceVariables=function(t){var n,r;return n=this.children.left.copy(),r=this.children.right.copy(),n instanceof e.Variable&&n.label in t?n.label=t[n.label]:null!=n.replaceVariables&&(n=n.replaceVariables(t)),r instanceof e.Variable&&r.label in t?r.label=t[r.label]:null!=r.replaceVariables&&(r=r.replaceVariables(t)),new p(n,r)},p.prototype.substituteExpression=function(t,n,r,o){var l,a,u,s,c,h,f,d,y,g,m,w,b,v,x,A,S;for(null==r&&(r=null),null==o&&(o=!1),d=o?t.solve(n,r):[t],null==r&&(r={get:function(t){return[t]}}),y=r.get(n),h=[],g=0,b=d.length;b>g;g++)for(l=d[g],s=[this.children.left.copy()],f=[this.children.right.copy()],this.children.left instanceof e.Variable&&(this.children.left.label===n||(A=this.children.left.label,i.call(y,A)>=0))?s=[l.copy()]:this.children.left instanceof e.Terminal||(s=this.children.left.substituteExpression(l,n,r)),this.children.right instanceof e.Variable&&(this.children.right.label===n||(S=this.children.right.label,i.call(y,S)>=0))?f=[l.copy()]:this.children.right instanceof e.Terminal||(f=this.children.right.substituteExpression(l,n,r)),m=0,v=s.length;v>m;m++)for(a=s[m],w=0,x=f.length;x>w;w++)u=f[w],c=new p(a,u),c=c.expandAndSimplify(r),h.push(c);return h},p.prototype.toDrawingNode=function(){var t,n,r,i;return i=null!=s?s.Surd:void 0,r=s.Pow,t=s.Fraction,n=s.Number,this.children.right instanceof e.Constant&&1===this.children.right.numerator?1===this.children.right.denominator?this.children.left.toDrawingNode():this.children.right.denominator>0?new i(this.children.left.toDrawingNode(),this.children.right.denominator):new t(new n(1),new i(this.children.left.toDrawingNode(),-this.children.right.denominator)):new r(this.children.left.toDrawingNode(),this.children.right.toDrawingNode())},p.prototype.differentiate=function(t){var n,e,r,o;if(n=a("operators/Add"),r=a("operators/Mul"),e=a("terminals").Constant,i.call(this.children.right.getAllVariables,t)>=0)throw new Error("I can't differentiate with a variable on the top of a power");return 0===("function"==typeof(o=this.children.right).evaluate?o.evaluate():void 0)?new e(0):new r(new p(this.children.left,new n(this.children.right,new e(-1))),this.children.left.differentiate(t),this.children.right).expandAndSimplify()},p}(t.BinaryNode)})}.call(this),function(){e("operators",["operators/Add","operators/Mul","operators/Pow"],function(t,n,e){return{Add:t,Mul:n,Pow:e}})}.call(this),function(){e("Expression",["parse","nodes"],function(t){var n;return n=function(){function n(n){if(n instanceof String||"string"==typeof n)this.expr=t.stringToExpression(n);else{if(null==n.copy)throw console.log("Received argument: ",n),new Error("Unknown argument: `"+n+"'.");this.expr=n.copy()}}return n.prototype.toString=function(){return this.expr.toString()},n.prototype.toMathML=function(){return this.expr.toMathML()},n.prototype.toLaTeX=function(){return this.expr.toLaTeX()},n.prototype.solve=function(t){var e,r,i,o,l;for(o=this.expr.solve(t),l=[],r=0,i=o.length;i>r;r++)e=o[r],l.push(new n(e));return l},n.prototype.sub=function(t){var e,r;r={};for(e in t)r[e]=t[e]instanceof n?t[e].expr:t[e];return new n(this.expr.sub(r,null,null).simplify())},n.prototype.copy=function(){return new n(this.expr.copy())},n.prototype.simplify=function(){return new n(this.expr.simplify())},n.prototype.expand=function(){return new n(this.expr.expand())},n}()})}.call(this),function(){n.config({baseUrl:"./"}),e("coffeequate",["operators","Expression","parse"],function(t,n,e){var r;return r=function(r){var i,o,l,a;return/\=/.test(r)?(a=r.split("="),i=a[0],o=a[1],l=new t.Add(e.stringToExpression(o),new t.Mul(e.stringToExpression(i),"-1")),new n(l)):new n(r)}})}.call(this),n(["coffeequate"]),n("coffeequate")});